- Turn sandboxing on
- trusted-substituters list
- substituters priority
  - ?priority=50 at the client
- DOCKER_BUILDKIT=0 docker build
  - If it is intended to build a Docker image inside the build
- Handbook: talk about sysbox
- Sysbox inside of sysbox

nsjail --really_quiet -R "/dev/null" -R "/dev/urandom" -s "/proc/self/fd:/dev/fd" -s "/proc/self/fd/0:/dev/stdin" -s "/proc/self/fd/1:/dev/stdout" -s "/proc/self/fd/2:/dev/stderr" -s "/dev/null:/etc/passwd" -R "$PWD:/app" -R /usr/lib -R /lib64 --user=65534 --group=65534 -- /app/a.out
nsjail --really_quiet -m none:/tmp:tmpfs -R "/dev/null" -R "/dev/urandom" -B /app:/app --cwd /app -R /usr/bin -R /nix -e --chroot / --user=99999 --group=99999 -- /nix/store/fviln222hm2x4mwxmgc0jh4sb1wknd5z-nix-2.19.3/bin/nix-shell --run "python3 test.py"
nsjail --really_quiet -m none:/tmp:tmpfs -R "/dev/null" -R "/dev/urandom" -R /app:/app --cwd /app -E 'HOME=/tmp' -E 'NIX_REMOTE=daemon' -R /nix -E --user=99999 --group=99999 -- /nix/store/fviln222hm2x4mwxmgc0jh4sb1wknd5z-nix-2.19.3/bin/nix-shell --run "python3 test.py"
nsjail --really_quiet -m none:/tmp:tmpfs -R "/dev/null" -R "/dev/urandom" -R /nix -R /root -R /app --cwd /app -e -E 'NIX_REMOTE=daemon' -R /nix --user=99999 --group=99999 -- /nix/store/fviln222hm2x4mwxmgc0jh4sb1wknd5z-nix-2.19.3/bin/nix-shell --run "rustc --version"
nsjail --hostname envicutor --really_quiet -m none:/tmp:tmpfs -R "/dev/null" -R "/dev/urandom" -R /nix -R /root -R /app --cwd /app -e -E 'NIX_REMOTE=daemon' -E 'USER=envicutor' --user=99999 --group=99999 -- /nix/store/fviln222hm2x4mwxmgc0jh4sb1wknd5z-nix-2.19.3/bin/nix-shell --run "id && rustc --version"
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix runner nsjail --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -- /bin/sleep 2
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix runner nsjail --really_quiet -t 1 --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -- /bin/sleep 3
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix runner nsjail --really_quiet -t 1 --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -- /nix/store/iwgkck1d64s5f26ngln540hpf06g28py-nix-2.20.1/bin/nix --help
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix runner nsjail --really_quiet -t 1 --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -- $(readlink -f /root/.nix-profile/bin/nix) --help
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix runner nsjail -t 1000 --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -E HOME=/tmp/home -E NIX_BIN=$(readlink -f /root/.nix-profile/bin/) -- /bin/bash -c 'mkdir /tmp/home && $NIX_BIN/nix-build -v shell.nix'
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix:ro runner nsjail -t 1000 --rlimit_fsize inf --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -E HOME=/tmp/home -E NIX_REMOTE=daemon -E NIX_BIN=$(readlink -f /root/.nix-profile/bin/) -- /bin/bash -c 'mkdir /tmp/home && $NIX_BIN/nix-build -v shell.nix'
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix runner nsjail -t 1000 --rlimit_fsize inf --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -E HOME=/tmp/home -E NIX_REMOTE=daemon -E NIX_BIN=$(readlink -f /root/.nix-profile/bin/) -- /bin/bash -c 'mkdir /tmp/home && $NIX_BIN/nix-shell -v shell.nix --run "sleep 0"'
docker run --user runner1003 --rm -it -v /app:/app -v /nix:/nix runner nsjail -t 1000 --rlimit_fsize inf --disable_clone_newuser --disable_proc --disable_clone_newns --disable_clone_newpid --disable_clone_newipc --disable_clone_newuts --disable_clone_newcgroup -N -B /app --cwd /app -B /tmp -R /nix -R /bin -R /lib:/lib -E HOME=/tmp/home -E NIX_REMOTE=daemon -E NIX_BIN=$(readlink -f /root/.nix-profile/bin/) -- /bin/bash -c 'export PATH=/bin:$PATH && mkdir /tmp/home && $NIX_BIN/nix-shell -v shell.nix --run "sleep 0"'
